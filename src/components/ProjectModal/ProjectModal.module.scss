@import '../../styles/abstracts/variables';
@import '../../styles/abstracts/mixins';

// Overlay (backdrop)
.modalOverlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.85);
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: $z-modal;
  padding: $space-lg;
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

// Modal content
.modalContent {
  position: relative;
  width: 100%;
  max-width: 1400px;
  max-height: 90vh;
  background: var(--bg-card);
  border-radius: $radius-xl;
  overflow: hidden;
  box-shadow: $shadow-2xl;
  animation: slideUp 0.3s ease-out;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

// Close button
.closeButton {
  @include reset-button;
  position: absolute;
  top: $space-lg;
  right: $space-lg;
  z-index: 10;
  width: 44px;
  height: 44px;
  background: rgba(var(--primary-rgb), 0.1);
  backdrop-filter: blur(10px);
  border-radius: $radius-md;
  color: var(--primary);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;

  &:hover {
    background: rgba(var(--primary-rgb), 0.1);
    transform: scale(1.1);
    border: 2px solid var(--primary);
  }

  svg {
    width: 24px;
    height: 24px;
  }
}

// Modal body
.modalBody {
  display: grid;
  grid-template-columns: 1fr 1fr;
  max-height: 90vh;

  @include respond-to-max('lg') {
    grid-template-columns: 1fr;
  }
}

// Left side - Images
.imageSection {
  padding: $space-xl $space-2xl; // Reduced top/bottom padding
  background: var(--bg-main);
  display: flex;
  flex-direction: column;
  gap: $space-md;
  max-height: 90vh;
  overflow: hidden;
}

.title {
  font-family: $font-heading;
  font-size: $text-3xl;
  font-weight: $font-bold;
  color: var(--text-primary);
  margin: 0;
  flex-shrink: 0; // Don't shrink title

  @include respond-to('lg') {
    font-size: $text-4xl;
  }
}

// Images grid layout
.imagesGrid {
  flex: 1;
  display: grid;
  gap: $space-md;
  min-height: 0;
  max-height: 100%; // Don't exceed parent height
  overflow: hidden; // Hide overflow
}

// View 1: 2 colonnes en haut + 1 grande en bas (Argent Bank)
.view1 {
  grid-template-columns: 1fr 1fr;
  grid-template-rows: 1fr 1fr;
  
  .imageWrapper:nth-child(1) {
    grid-column: 1;
    grid-row: 1;
  }
  
  .imageWrapper:nth-child(2) {
    grid-column: 2;
    grid-row: 1;
  }
  
  .imageWrapper:nth-child(3) {
    grid-column: 1 / -1;
    grid-row: 2;
  }
}

// View 2: 2 images verticales (une au-dessus de l'autre) (Print It, Kasa)
.view2 {
  grid-template-columns: 1fr;
  grid-template-rows: 1fr 1fr;
  gap: $space-sm; // Smaller gap between images
  
  .imageWrapper:nth-child(1) {
    grid-column: 1;
    grid-row: 1;
  }
  
  .imageWrapper:nth-child(2) {
    grid-column: 1;
    grid-row: 2;
  }
  
  .imageWrapper {
    min-height: 0; // Allow images to shrink
  }
}

// View 3: 3 images verticales empilées (une au-dessus de l'autre)
.view3 {
  grid-template-columns: 1fr;
  grid-template-rows: 1fr 1fr 1fr;
  
  .imageWrapper:nth-child(1) { 
    grid-column: 1; 
    grid-row: 1;
    
    // Pour Nina : voir les scores complets
    .image {
      object-fit: contain;
      background: #1a1a1a; // Dark background for lighthouse scores
    }
  }
  
  .imageWrapper:nth-child(2) { 
    grid-column: 1; 
    grid-row: 2;
    
    // Pour Nina : voir les scores complets
    .image {
      object-fit: contain;
      background: #1a1a1a;
    }
  }
  
  .imageWrapper:nth-child(3) { 
    grid-column: 1; 
    grid-row: 3; 
  }
  
  // Si plus de 3 images (comme Nina avec 6), afficher en grid
  &:has(.imageWrapper:nth-child(4)) {
    grid-template-columns: 1fr 1fr 1fr;
    grid-template-rows: 1fr 1fr;
    
    .imageWrapper:nth-child(1) { 
      grid-column: 1; 
      grid-row: 1;
      
      .image {
        object-fit: contain;
        background: #1a1a1a;
      }
    }
    .imageWrapper:nth-child(2) { 
      grid-column: 2; 
      grid-row: 1;
      
      .image {
        object-fit: contain;
        background: #1a1a1a;
      }
    }
    .imageWrapper:nth-child(3) { grid-column: 3; grid-row: 1; }
    .imageWrapper:nth-child(4) { grid-column: 1; grid-row: 2; }
    .imageWrapper:nth-child(5) { grid-column: 2; grid-row: 2; }
    .imageWrapper:nth-child(6) { grid-column: 3; grid-row: 2; }
  }
}

// View 4: 2 images à gauche (verticales) + 1 grande à droite (Booki, OhMyFood)
.view4 {
  grid-template-columns: 1fr 1fr;
  grid-template-rows: 1fr 1fr;
  
  .imageWrapper:nth-child(1) {
    grid-column: 1;
    grid-row: 1;
  }
  
  .imageWrapper:nth-child(2) {
    grid-column: 1;
    grid-row: 2;
  }
  
  .imageWrapper:nth-child(3) {
    grid-column: 2;
    grid-row: 1 / -1; // Span both rows
  }
}

// Single image fallback
.view1, .view2, .view3, .view4 {
  .imageWrapper:only-child {
    grid-column: 1 / -1;
    grid-row: 1 / -1;
  }
}

.imageWrapper {
  position: relative;
  background: var(--bg-alt);
  border-radius: $radius-lg;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 0;
  cursor: pointer;
  transition: transform 0.3s ease;

  &:hover {
    transform: scale(1.02);
    
    .imageOverlay {
      opacity: 1;
    }
  }
}

.image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

// Overlay sur l'image au hover avec icône
.imageOverlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.3s ease;
  
  svg {
    color: white;
    width: 48px;
    height: 48px;
  }
}

.noImage {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-alt);
  border-radius: $radius-lg;
  color: var(--text-muted);
}

// Right side - Details
.detailsSection {
  padding: $space-xl;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: $space-md; // Reduced gap

  // Custom scrollbar
  &::-webkit-scrollbar {
    width: 8px;
  }

  &::-webkit-scrollbar-track {
    background: var(--bg-alt);
    border-radius: 4px;
  }

  &::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 4px;
    
    &:hover {
      background: var(--border-hover);
    }
  }
}

.subtitle {
  font-family: $font-heading;
  font-size: $text-lg;
  font-weight: $font-bold;
  color: var(--text-primary);
  margin: 0;
}

// Tags
.tags {
  display: flex;
  flex-wrap: wrap;
  gap: $space-sm;
}

.tag {
  padding: $space-xs $space-md;
  background: rgba(var(--primary-rgb), 0.1);
  color: var(--secondary);
  border-radius: $radius-md;
  font-size: $text-sm;
  font-weight: $font-medium;
}

// Content blocks
.block {
  display: flex;
  flex-direction: column;
  gap: $space-xs;
}

.blockTitle {
  font-family: $font-heading;
  font-size: $text-lg;
  font-weight: $font-bold;
  color: var(--text-primary);
  margin: 0;
}

.blockText {
  font-size: $text-base;
  color: var(--text-secondary);
  line-height: $leading-relaxed;
  margin: 0;
}

// Skills
.skills {
  display: flex;
  flex-wrap: wrap;
  gap: $space-sm;
}

.skill {
  padding: $space-xs $space-md;
  background: rgba(var(--primary-rgb), 0.1);
  border: 1px solid var(--border);
  border-radius: $radius-md;
  font-size: $text-sm;
  color: var(--secondary);
}

// Footer
.footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: $space-md;
  border-top: 2px solid var(--border);
  margin-top: auto;
  flex-wrap: wrap;
  gap: $space-md;
}

.metaInfo {
  display: flex;
  gap: $space-lg;
  font-size: $text-sm;
  color: var(--text-muted);
  flex-wrap: wrap;
}

.date,
.duration {
  display: flex;
  align-items: center;
  gap: $space-xs;
  
  svg {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }
}

.githubLink {
  @include reset-link;
  display: flex;
  align-items: center;
  gap: $space-sm;
  padding: $space-sm $space-lg;
  background: var(--primary); // Changed from var(--text-primary)
  color: white; // Changed from var(--bg-card)
  border-radius: $radius-full;
  font-size: $text-sm;
  font-weight: $font-semibold;
  transition: all 0.3s ease;
  white-space: nowrap;

  &:hover {
    transform: translateY(-2px);
    box-shadow: $shadow-lg;
    background: var(--primary);
    border: 3px solid var(--secondary);
  }

  svg {
    width: 20px;
    height: 20px;
    flex-shrink: 0;
    fill: white; // Ensure icon is white
  }
  
  span {
    display: inline;
    color: white; // Explicitly set text to white
    
    @include respond-to-max('sm') {
      display: none;
    }
  }
}

// Lightbox
.lightbox {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.95);
  backdrop-filter: blur(10px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: calc(#{$z-modal} + 10);
  padding: $space-2xl;
  animation: fadeIn 0.3s ease-out;
  cursor: zoom-out;
}

.closeLightbox {
  @include reset-button;
  position: absolute;
  top: $space-2xl;
  right: $space-2xl;
  width: 56px;
  height: 56px;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border-radius: $radius-full;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  cursor: pointer;

  &:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
  }

  svg {
    width: 32px;
    height: 32px;
  }
}

.lightboxImage {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
  border-radius: $radius-lg;
  box-shadow: $shadow-2xl;
  animation: scaleIn 0.3s ease-out;
  cursor: default;
}

@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

// Responsive
@include respond-to-max('lg') {
  .modalBody {
    max-height: 85vh;
  }

  .imageSection,
  .detailsSection {
    padding: $space-lg;
  }

  .title {
    font-size: $text-2xl;
  }
  
  // Adjust grids for tablet
  .view3 {
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr 1fr;
    
    .imageWrapper:nth-child(3) { grid-column: 1; grid-row: 2; }
    .imageWrapper:nth-child(4) { grid-column: 2; grid-row: 2; }
    .imageWrapper:nth-child(5) { grid-column: 1; grid-row: 3; }
    .imageWrapper:nth-child(6) { grid-column: 2; grid-row: 3; }
  }
}

@include respond-to-max('md') {
  .modalOverlay {
    padding: $space-md;
  }

  .closeButton {
    top: $space-sm;
    right: $space-sm;
  }

  .imageSection,
  .detailsSection {
    padding: $space-md;
  }
  
  // Stack all layouts vertically on mobile
  .view1, .view2, .view3, .view4 {
    grid-template-columns: 1fr;
    grid-auto-rows: minmax(200px, auto);
    
    .imageWrapper {
      grid-column: 1 !important;
      grid-row: auto !important;
    }
  }
}